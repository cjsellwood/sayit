(this.webpackJsonpsayit=this.webpackJsonpsayit||[]).push([[0],{25:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){},44:function(t,e,n){},46:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){"use strict";n.r(e);var o=n(1),c=n.n(o),i=n(19),s=n.n(i),r=(n(33),n(34),n(5)),a=n(3),l=n(20),u="AUTHORIZE",d="DEAUTHORIZE",b="TOGGLE_REGISTER_MODAL",m="TOGGLE_LOGIN_MODAL",j="LOAD_POSTS",h="SET_SINGLE_POST",p="TOGGLE_EDIT_POST",f="EDIT_POST_INPUT",O="ADD_COMMENT",g="TOGGLE_REPLY_FORM",x="REPLY_INPUT",v="RESET_REPLY_INPUT",w="SET_DELETED_COMMENT",S="TOGGLE_EDIT_COMMENT",y="EDIT_COMMENT_INPUT",N="TOGGLE_SHOW_COMMENT",T="SET_SINGLE_POST_COMMENTS",_="SET_TOPICS",E="SET_ADDED_TOPIC",C="SET_SIDEBAR",I="TOGGLE_SIDEBAR",P="SET_ERROR",L="SET_SUCCESS",R="SET_LOADING",M="SET_TIMEOUT",D=function(t){return{type:P,error:t}},k=function(t){return{type:L,success:t}},A=function(t){return{type:R,loading:t}},F=function(t){return{type:M,timeout:t}},G=function(t){return{type:u,user_id:t}},z=function(){return function(t){t((localStorage.removeItem("token"),localStorage.removeItem("expires"),{type:d})),t(k("Logged Out"))}},U=function(){return{type:b}},q=function(){return{type:m}},B="http://localhost:3000",H=n(2),J=function(t){return{type:O,comment:t}},V=function(t){return{type:g,comment_id:t}},Y=function(t,e,n){return function(o){o(A(!0));var c=localStorage.getItem("token");fetch("".concat(B,"/comments/new"),{method:"POST",body:JSON.stringify({text:t,post_id:e,parent:n}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}}).then((function(t){return t.json()})).then((function(t){if(console.log(t),t.error)throw new Error(t.error);o(J(t.comment)),o({type:v,comment_id:n}),o(V(n)),o(A(!1)),o(k(t.message))})).catch((function(t){o(A(!1)),o(D(t.message))}))}},X=function(t){return function(e){e(A(!0));var n=localStorage.getItem("token");fetch("".concat(B,"/comments/").concat(t,"/delete"),{method:"DELETE",body:JSON.stringify({comment_id:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(t){return t.json()})).then((function(n){if(console.log(n),n.error)throw new Error(n.error);e(function(t){return{type:w,comment_id:t}}(t)),e(A(!1)),e(k(n.message))})).catch((function(t){e(A(!1)),e(D(t.message))}))}},Z=function(t,e){return{type:S,comment_id:t,canceled:e}},W=function(t){return{type:j,posts:t}},K=function(t,e){return{type:h,post:t}},Q=function(t){return function(e){e(A(!0)),e(K({})),fetch("".concat(B,"/posts/").concat(t)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);var n;e(K(t.post)),e((n=t.comments,{type:T,comments:n})),e(A(!1))})).catch((function(t){e(D(t.message)),e(A(!1))}))}},$=function(t){return{type:p,canceled:t}},tt=function(t){return{type:_,topics:t}},et=function(t){return function(e){e(A(!0)),fetch("".concat(B,"/posts/singletopic"),{method:"POST",body:JSON.stringify({topic:t}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e(function(t){return{type:E,topic:t}}(t.topic)),e(A(!1))})).catch((function(t){e(A(!1)),e(D(t.message))}))}},nt=function(t,e,n){return{type:C,isHome:t,name:e,description:n}},ot=function(){return{type:I}};function ct(){var t=Object(r.g)().pathname;return Object(o.useEffect)((function(){window.scrollTo(0,0)}),[t]),null}var it=n(6),st=(n(44),n(0)),rt=Object(a.b)((function(t){return{isAuth:t.auth.isAuth,sidebar:t.sidebar.sidebar,sidebarShow:t.sidebar.show}}),(function(t){return{onToggleSidebar:function(){t(ot())}}}))((function(t){return Object(st.jsx)("nav",{className:"Nav",children:Object(st.jsxs)("ul",{children:[t.sidebar.isHome?Object(st.jsx)("li",{children:Object(st.jsx)(it.b,{to:"/",children:"Sayit"})}):Object(st.jsx)("li",{children:Object(st.jsx)(it.b,{to:"/topics/".concat(t.sidebar.name),children:t.sidebar.name})}),Object(st.jsx)("button",{className:"menu-button",onClick:t.onToggleSidebar,"aria-label":"toggle-sidebar",children:t.sidebarShow?Object(st.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(st.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}):Object(st.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(st.jsx)("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})})})]})})})),at=function(t){var e=(Date.now()-new Date(t))/1e3;return e<60?"".concat(e.toFixed(0)," seconds ago"):e<3600?"".concat((e/60).toFixed(0)," minutes ago"):e<86400?"".concat((e/3600).toFixed(0)," hours ago"):e<31536e3?"".concat((e/86400).toFixed(0)," days ago"):"".concat((e/31536e3).toFixed(0)," years ago")},lt=Object(a.b)((function(t){return{posts:t.posts.posts}}),(function(t){return{onGetPosts:function(){t((function(t){t(A(!0)),t(W([])),fetch("".concat(B,"/posts")).then((function(t){return t.json()})).then((function(e){if(e.error)throw new Error(e.error);t(W(e.posts)),t(A(!1))})).catch((function(e){t(D(e.message)),t(A(!1))}))}))},onSetSidebar:function(e,n,o){t(nt(e,n,o))}}}))((function(t){Object(o.useEffect)((function(){t.onGetPosts(),t.onSetSidebar(!0,"","")}),[]);var e=t.posts.map((function(t,e){return Object(st.jsxs)("li",{children:[Object(st.jsx)("div",{className:"post-number",children:Object(st.jsx)("p",{children:e+1})}),Object(st.jsx)("div",{className:"post-votes",children:Object(st.jsx)("p",{children:"Votes"})}),Object(st.jsxs)("div",{children:[Object(st.jsx)("div",{className:"post-title",children:Object(st.jsx)(it.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(st.jsxs)("p",{className:"post-subtitle",children:["submitted ",at(t.time)," by"," ",Object(st.jsx)("span",{className:"post-username",children:t.username})," in"," ",Object(st.jsx)(it.b,{to:"/topics/".concat(t.topic),children:t.topic})]})]})]},t.post_id)}));return Object(st.jsx)("section",{className:"Home",children:Object(st.jsx)("ul",{className:"posts-list",children:e})})})),ut=n(10),dt=n(11),bt=(n(46),Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onUserRegister:function(e,n){t(function(t,e){return function(e){e(A(!0)),fetch("http://localhost:3000/register",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);localStorage.setItem("token",t.token);var n=Date.now()+Number(t.expiresIn);localStorage.setItem("expires",n);var o=Object(l.a)(localStorage.getItem("token"));e(G(o.sub)),e(U()),e(A(!1)),e(k(t.message))})).catch((function(t){e(A(!1)),e(D(t.message))}))}}(e))},onToggleRegisterModal:function(){t(U())}}}))((function(t){var e=Object(o.useState)({username:"",password:"",confirmPassword:""}),n=Object(dt.a)(e,2),c=n[0],i=n[1],s=Object(r.f)(),a=function(t){i(Object(H.a)(Object(H.a)({},c),{},Object(ut.a)({},t.target.name,t.target.value)))};return Object(st.jsx)("section",{className:"modal-wrapper",onClick:function(e){e.currentTarget===e.target&&t.onToggleRegisterModal()},children:Object(st.jsxs)("div",{children:[Object(st.jsx)("h1",{children:"Register"}),Object(st.jsx)("button",{className:"modal-close-button",onClick:t.onToggleRegisterModal,"aria-label":"close form",children:Object(st.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(st.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}),Object(st.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),t.onUserRegister(c,s)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"username",children:"Username"}),Object(st.jsx)("input",{type:"text",name:"username",value:c.username,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"password",children:"Password"}),Object(st.jsx)("input",{type:"password",name:"password",value:c.password,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),Object(st.jsx)("input",{type:"password",name:"confirmPassword",value:c.confirmPassword,onChange:a,required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:t.loading?"disabled":null,children:"Register"})]})]})})}))),mt=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onUserLogin:function(e,n){t(function(t,e){return function(e){e(A(!0)),fetch("http://localhost:3000/login",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);localStorage.setItem("token",t.token);var n=Date.now()+Number(t.expiresIn);localStorage.setItem("expires",n),e(G()),e(q()),e(A(!1)),e(k(t.message))})).catch((function(t){e(A(!1)),e(D(t.message))}))}}(e))},onToggleLoginModal:function(){t(q())}}}))((function(t){var e=Object(o.useState)({username:"",password:""}),n=Object(dt.a)(e,2),c=n[0],i=n[1],s=Object(r.f)(),a=function(t){i(Object(H.a)(Object(H.a)({},c),{},Object(ut.a)({},t.target.name,t.target.value)))};return Object(st.jsx)("section",{className:"modal-wrapper",onClick:function(e){e.currentTarget===e.target&&t.onToggleLoginModal()},children:Object(st.jsxs)("div",{children:[Object(st.jsx)("h1",{children:"Login"}),Object(st.jsx)("button",{className:"modal-close-button",onClick:t.onToggleLoginModal,"aria-label":"close form",children:Object(st.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(st.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}),Object(st.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),t.onUserLogin(c,s)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"username",children:"Username"}),Object(st.jsx)("input",{type:"text",name:"username",value:c.username,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"password",children:"Password"}),Object(st.jsx)("input",{type:"password",name:"password",value:c.password,onChange:a,required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:t.loading?"disabled":null,children:"Login"})]})]})})})),jt=(n(47),Object(a.b)((function(t){return{}}),(function(t){return{onNewPost:function(e,n){t(function(t,e){return function(n){n(A(!0));var o=localStorage.getItem("token");fetch("".concat(B,"/posts/new"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(o){if(console.log(o),o.error)throw new Error(o.error);e.push("/topics/".concat(t.topic,"/").concat(o.post_id)),n(A(!1)),n(k(o.message))})).catch((function(t){n(D(t.message)),n(A(!1))}))}}(e,n))}}}))((function(t){var e=Object(r.f)(),n=Object(o.useState)({title:"",text:"",topic:""}),c=Object(dt.a)(n,2),i=c[0],s=c[1];Object(o.useEffect)((function(){e.location.state&&s(Object(H.a)(Object(H.a)({},i),{},{topic:e.location.state.topic}))}),[]);var a=function(t){s(Object(H.a)(Object(H.a)({},i),{},Object(ut.a)({},t.target.name,t.target.value)))};return Object(st.jsxs)("section",{children:[Object(st.jsx)("h1",{className:"page-title",children:"New Post"}),Object(st.jsxs)("form",{className:"auth-form new-post-form",onSubmit:function(n){n.preventDefault(),t.onNewPost(i,e)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"title",children:"Title*"}),Object(st.jsx)("input",{type:"text",name:"title",value:i.title,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"text",children:"Text"}),Object(st.jsx)("textarea",{type:"text",name:"text",value:i.text,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"topic",children:"Topic*"}),Object(st.jsx)("input",{type:"text",name:"topic",value:i.topic,onChange:a,required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",children:"Submit"})]})]})}))),ht=(n(48),Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onNewTopic:function(e,n){t(function(t,e){return function(n){n(A(!0));var o=localStorage.getItem("token");t.name=t.name.split(" ").join("").toLowerCase(),fetch("".concat(B,"/newtopic"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(o){if(console.log(o),o.error)throw new Error(o.error);e.push("/topics/".concat(t.name)),n(A(!0)),n(k(o.message))})).catch((function(t){n(A(!1)),n(D(t.message))}))}}(e,n))},onSetSidebar:function(e,n,o){t(nt(e,n,o))}}}))((function(t){var e=Object(r.f)();Object(o.useEffect)((function(){t.onSetSidebar(!0,"","")}),[]);var n=Object(o.useState)({name:"",description:""}),c=Object(dt.a)(n,2),i=c[0],s=c[1],a=function(t){s(Object(H.a)(Object(H.a)({},i),{},Object(ut.a)({},t.target.name,t.target.value)))};return Object(st.jsxs)("section",{children:[Object(st.jsx)("h1",{className:"page-title",children:"New Topic"}),Object(st.jsxs)("form",{className:"auth-form new-topic-form",onSubmit:function(n){n.preventDefault(),t.onNewTopic(i,e)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"name",children:"Name*"}),Object(st.jsx)("input",{type:"text",name:"name",value:i.name,onChange:a,required:!0})]}),Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"text",children:"Description*"}),Object(st.jsx)("input",{type:"text",name:"description",value:i.description,onChange:a,required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!t.loading&&"disabled",children:"Submit"})]})]})}))),pt=Object(a.b)((function(t){return{posts:t.posts.posts,topics:t.topics.topics,error:t.flash.error,loading:t.flash.loading}}),(function(t){return{onGetTopicPosts:function(e){t(function(t){return function(e){e(A(!0)),e(W([])),fetch("".concat(B,"/posts/topics/").concat(t)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e(W(t.posts)),e(A(!1))})).catch((function(t){e(D(t.message)),e(A(!1))}))}}(e))},onAddTopic:function(e){t(et(e))},onSetSidebar:function(e,n,o){t(nt(e,n,o))}}}))((function(t){var e=Object(r.h)().topic;Object(o.useEffect)((function(){t.onGetTopicPosts(e)}),[e]),Object(o.useEffect)((function(){var n=-1;t.topics.length&&(n=t.topics.findIndex((function(t){return t&&t.name===e}))),-1===n&&t.onAddTopic(e),-1!==n&&t.onSetSidebar(!1,t.topics[n].name,t.topics[n].description)}),[e,t.topics]);var n=t.posts.map((function(t,e){return Object(st.jsxs)("li",{children:[Object(st.jsx)("div",{className:"post-number",children:Object(st.jsx)("p",{children:e+1})}),Object(st.jsx)("div",{className:"post-votes",children:Object(st.jsx)("p",{children:"Votes"})}),Object(st.jsxs)("div",{children:[Object(st.jsx)("div",{className:"post-title",children:Object(st.jsx)(it.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(st.jsxs)("p",{className:"post-subtitle",children:["submitted ",at(t.time)," by",Object(st.jsxs)("span",{className:"comment-username",children:[" ",t.username]})]})]})]},t.post_id)}));return Object(st.jsx)("section",{children:Object(st.jsx)("ul",{className:"posts-list",children:n})})})),ft=Object(a.b)((function(t){return{user_id:t.auth.user_id}}))((function(t){return t.user_id===t.creator_id?Object(st.jsx)(c.a.Fragment,{children:t.children}):null})),Ot=Object(a.b)((function(t){return{isAuth:t.auth.isAuth}}))((function(t){return t.isAuth?Object(st.jsx)(c.a.Fragment,{children:t.children}):null})),gt=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onToggleReplyForm:function(e){t(V(e))},onCommentReply:function(e,n,o){t(Y(e,n,o))},onReplyInput:function(e,n){t(function(t,e){return{type:x,value:t,comment_id:e}}(e,n))},onDeleteComment:function(e){t(X(e))},onToggleEditComment:function(e,n){t(Z(e,n))},onEditCommentInput:function(e,n){t(function(t,e){return{type:y,value:t,comment_id:e}}(e,n))},onEditComment:function(e,n){t(function(t,e){return function(n){n(A(!0));var o=localStorage.getItem("token");fetch("".concat(B,"/comments/").concat(e,"/edit"),{method:"PATCH",body:JSON.stringify({text:t,comment_id:e}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(console.log(t),t.error)throw new Error(t.error);n(Z(e)),n(A(!1))})).catch((function(t){n(A(!1)),n(D(t.message))}))}}(e,n))},onToggleShowComment:function(e){t(function(t){return{type:N,comment_id:t}}(e))}}}))((function t(e){var n=e.allComments.filter((function(t){return t.parent===e.comment.comment_id})),o=null;return e.comment.show&&(o=Object(st.jsxs)(c.a.Fragment,{children:[e.comment.editing?Object(st.jsxs)("form",{className:"edit-comment-form",onSubmit:function(t){t.preventDefault(),e.onEditComment(e.comment.text,e.comment.comment_id)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"editComment"}),Object(st.jsx)("textarea",{name:"text",id:"editComment",value:e.comment.text,onChange:function(t){return e.onEditCommentInput(t.target.value,e.comment.comment_id)},required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit",children:"Submit"}),Object(st.jsx)("button",{className:"basic-button",type:"button",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleEditComment(e.comment.comment_id,!0)},children:"Cancel"})]}):Object(st.jsx)("div",{className:"comment-text",children:Object(st.jsx)("p",{children:e.comment.text})}),Object(st.jsxs)(Ot,{children:[Object(st.jsxs)("div",{className:"comment-buttons",children:[Object(st.jsx)("button",{"data-index":e.index,disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleReplyForm(e.comment.comment_id)},children:"Reply"}),Object(st.jsxs)(ft,{creator_id:e.comment.user_id,children:[Object(st.jsx)("button",{type:"button","aria-label":"delete",disabled:!!e.loading&&"disabled",onClick:function(){return e.onDeleteComment(e.comment.comment_id)},children:"Delete"}),Object(st.jsx)("button",{type:"edit","aria-label":"edit",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleEditComment(e.comment.comment_id)},children:"Edit"})]})]}),e.comment.showReply?Object(st.jsxs)("form",{className:"reply-form",onSubmit:function(t){t.preventDefault(),e.onCommentReply(e.comment.reply,e.post_id,e.comment.comment_id)},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"commentReply"}),Object(st.jsx)("textarea",{name:"comment",id:"commentReply",placeholder:"Reply",value:e.comment.reply,onChange:function(t){return e.onReplyInput(t.target.value,e.comment.comment_id)},required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!e.loading&&"disabled",children:"Submit"}),Object(st.jsx)("button",{className:"basic-button",type:"button","aria-label":"cancel",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleReplyForm(e.comment.comment_id)},children:"Cancel"})]}):null]}),Object(st.jsx)("ul",{children:n.map((function(n){return Object(st.jsx)(t,{allComments:e.allComments,comment:n,post_id:e.post_id,loading:e.loading,onToggleReplyForm:e.onToggleReplyForm,onReplyInput:e.onReplyInput,onCommentReply:e.onCommentReply,onDeleteComment:e.onDeleteComment,onToggleEditComment:e.onToggleEditComment,onEditCommentInput:e.onEditCommentInput,onEditComment:e.onEditComment,onToggleShowComment:e.onToggleShowComment},n.comment_id)}))})]})),Object(st.jsxs)("li",{className:"child",children:[Object(st.jsxs)("p",{className:"comment-subtitle",children:[Object(st.jsx)("button",{onClick:function(){return e.onToggleShowComment(e.comment.comment_id)},children:e.comment.show?"[\u2013]":"[+]"}),Object(st.jsx)("span",{className:"comment-username",children:e.comment.username}),at(e.comment.time)]}),e.comment.show?o:null]},e.comment.comment_id)})),xt=Object(a.b)((function(t){return{posts:t.posts.posts,post:t.posts.post,comments:t.comments.comments,topics:t.topics.topics,loading:t.flash.loading}}),(function(t){return{onSetSinglePost:function(e){t(K(e))},onGetSinglePost:function(e){t(Q(e))},onNewComment:function(e,n){t(function(t,e){return function(n){n(A(!0));var o=localStorage.getItem("token");fetch("".concat(B,"/comments/new"),{method:"POST",body:JSON.stringify(Object(H.a)(Object(H.a)({},t),{},{post_id:e})),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(console.log(t),t.error)throw new Error(t.error);n(J(t.comment)),n(A(!1)),n(k(t.message))})).catch((function(t){n(A(!1)),n(D(t.message))}))}}(e,n))},onDeletePost:function(e,n,o){t(function(t,e,n){return function(o){o(A(!0));var c=localStorage.getItem("token");fetch("".concat(B,"/posts/").concat(t,"/delete"),{method:"DELETE",body:JSON.stringify({post_id:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e.push("/topics/".concat(n)),o(A(!1)),o(k(t.message))})).catch((function(t){o(D(t.message)),o(A(!1))}))}}(e,n,o))},onToggleEditPost:function(e){t($(e))},onEditPostInput:function(e){t(function(t,e){return{type:f,value:t,post_id:e}}(e))},onEditPost:function(e,n){t(function(t,e){return function(n){n(A(!0));var o=localStorage.getItem("token");fetch("".concat(B,"/posts/").concat(e,"/edit"),{method:"PATCH",body:JSON.stringify({text:t,post_id:e}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);n($()),n(A(!1))})).catch((function(t){n(D(t.message)),n(A(!1))}))}}(e,n))},onSetSidebar:function(e,n,o){t(nt(e,n,o))},onAddTopic:function(e){t(et(e))}}}))((function(t){var e=Object(r.h)(),n=e.post_id,c=e.topic,i=Object(r.f)();Object(o.useEffect)((function(){t.post.post_id&&t.post.post_id===Number(n)||t.onGetSinglePost(n,c,i),t.post.post_id&&t.post.topic!==c&&i.replace("/topics/".concat(t.post.topic,"/").concat(n));var e=t.topics.findIndex((function(e){return e.name===t.post.topic}));t.post.topic&&-1===e&&t.onAddTopic(t.post.topic),t.post.topic&&-1!==e&&t.onSetSidebar(!1,t.topics[e].name,t.topics[e].description)}),[n,t.post.topic,t.topics]),Object(o.useEffect)((function(){}),[n]);var s=[];t.post.post_id&&Number(t.post.post_id)===Number(n)&&(s=Object(st.jsxs)("div",{className:"single-post",children:[Object(st.jsx)("div",{className:"post-votes",children:Object(st.jsx)("p",{children:"Votes"})}),Object(st.jsxs)("div",{className:"post-details",children:[Object(st.jsx)("div",{className:"post-title",children:Object(st.jsx)(it.b,{to:"/topics/".concat(t.post.topic,"/").concat(t.post.post_id),children:t.post.title})}),Object(st.jsxs)("p",{className:"post-subtitle",children:["submitted ",at(t.post.time)," by"," ",Object(st.jsx)("span",{className:"comment-username",children:t.post.username})]}),t.post.editing?Object(st.jsxs)("form",{className:"edit-post-form",onSubmit:function(e){e.preventDefault(),t.onEditPost(t.post.text,t.post.post_id)},children:[Object(st.jsx)("label",{htmlFor:"editPost","aria-label":"edit post"}),Object(st.jsx)("textarea",{id:"editPost",name:"text",value:t.post.text.toString(),onChange:function(e){return t.onEditPostInput(e.target.value)}}),Object(st.jsxs)("div",{children:[Object(st.jsx)("button",{className:"basic-button",type:"submit",disabled:!!t.loading&&"disabled",children:"Submit"}),Object(st.jsx)("button",{className:"basic-button",type:"button","aria-label":"cancel",disabled:!!t.loading&&"disabled",onClick:function(){return t.onToggleEditPost(!0)},children:"Cancel"})]})]}):Object(st.jsx)("div",{className:"post-text",children:Object(st.jsx)("p",{children:t.post.text})}),Object(st.jsx)(ft,{creator_id:t.post.user_id,children:Object(st.jsxs)("div",{className:"comment-buttons",children:[Object(st.jsx)("button",{type:"button","aria-label":"delete post",disabled:!!t.loading&&"disabled",onClick:function(){return t.onDeletePost(n,i,c)},children:"Delete"}),Object(st.jsx)("button",{type:"button","aria-label":"edit post",disabled:!!t.loading&&"disabled",onClick:function(){return t.onToggleEditPost()},children:"Edit"})]})})]})]}));var a=Object(o.useState)({text:""}),l=Object(dt.a)(a,2),u=l[0],d=l[1],b=t.comments.filter((function(t){return!t.parent})).map((function(e){return Object(st.jsx)(gt,{allComments:t.comments,comment:e,post_id:n},e.comment_id)}));return Object(st.jsxs)("section",{children:[s,t.post.post_id?Object(st.jsxs)("div",{className:"comments-section",children:[Object(st.jsx)("h2",{children:"Comments"}),Object(st.jsx)(Ot,{children:Object(st.jsxs)("form",{className:"new-comment-form",onSubmit:function(e){e.preventDefault(),t.onNewComment(u,n),d({text:""})},children:[Object(st.jsxs)("div",{children:[Object(st.jsx)("label",{htmlFor:"newComment","aria-label":"new comment"}),Object(st.jsx)("textarea",{name:"text",id:"newComment",placeholder:"New Comment",value:u.text,onChange:function(t){d(Object(H.a)(Object(H.a)({},u),{},Object(ut.a)({},t.target.name,t.target.value)))},required:!0})]}),Object(st.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!t.loading&&"disabled",children:"Submit"})]})}),Object(st.jsx)("ul",{children:b})]}):null]})})),vt=(n(49),Object(a.b)((function(t){return{topics:t.topics.topics}}),(function(t){return{onGetTopics:function(){t((function(t){t(A(!0)),t(tt([])),fetch("".concat(B,"/posts/topics")).then((function(t){return t.json()})).then((function(e){if(console.log(e),e.error)throw new Error(e.error);t(tt(e.topics)),t(A(!1))})).catch((function(e){t(A(!1)),t(D(e.message))}))}))},onSetSidebar:function(e,n,o){t(nt(e,n,o))}}}))((function(t){Object(o.useEffect)((function(){t.onGetTopics(),t.onSetSidebar(!0,"","")}),[]);var e=t.topics.map((function(t){return Object(st.jsxs)("li",{children:[Object(st.jsx)(it.b,{to:"/topics/".concat(t.name),children:t.name}),Object(st.jsx)("p",{children:t.description})]},t.topic_id)}));return Object(st.jsxs)("section",{children:[Object(st.jsx)("h1",{className:"page-title",children:"Topics"}),Object(st.jsx)("ul",{className:"topics-list",children:e})]})}))),wt=Object(a.b)((function(t){return{isAuth:t.auth.isAuth}}))((function(t){return t.isAuth?null:Object(st.jsx)(c.a.Fragment,{children:t.children})})),St=(n(50),Object(a.b)((function(t){return{sidebar:t.sidebar.sidebar,show:t.sidebar.show,loading:t.flash.loading}}),(function(t){return{onToggleSidebar:function(){t(ot())},onUserLogout:function(){t(z())},onToggleLoginModal:function(){t(q())},onToggleRegisterModal:function(){t(U())}}}))((function(t){var e=Object(o.useState)(""),n=Object(dt.a)(e,2),c=n[0],i=n[1],s=Object(r.f)();return Object(st.jsxs)("aside",{className:"sidebar ".concat(t.show?"open":""),onClick:t.onToggleSidebar,children:[Object(st.jsx)("form",{onSubmit:function(t){t.preventDefault(),s.push("/search?q=".concat(c)),i("")},children:Object(st.jsxs)("div",{className:"search-bar",children:[Object(st.jsx)("label",{htmlFor:"search"}),Object(st.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"search",value:c,onChange:function(t){i(t.target.value)},required:!0}),Object(st.jsx)("button",{type:"submit","aria-label":"search",children:Object(st.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(st.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})})]})}),Object(st.jsxs)("div",{className:"sidebar-links",children:[Object(st.jsx)(it.b,{to:"/topics",children:"Topics"}),Object(st.jsxs)(Ot,{children:[Object(st.jsx)(it.b,{to:{pathname:"/newpost",state:{topic:t.sidebar.name}},children:"New Post"}),t.sidebar.isHome?Object(st.jsx)(it.b,{to:"/newtopic",children:"New Topic"}):null]})]}),Object(st.jsxs)("ul",{className:"auth-links",children:[Object(st.jsx)(wt,{children:Object(st.jsx)("li",{children:Object(st.jsx)("button",{className:"basic-button",disabled:!!t.loading&&"disabled",onClick:function(e){t.onToggleRegisterModal()},"aria-label":"register",children:"Register"})})}),Object(st.jsx)(wt,{children:Object(st.jsx)("li",{children:Object(st.jsx)("button",{className:"basic-button",disabled:!!t.loading&&"disabled",onClick:function(e){t.onToggleLoginModal()},"aria-label":"login",children:"Login"})})}),Object(st.jsx)(Ot,{children:Object(st.jsx)("li",{children:Object(st.jsx)("button",{disabled:!!t.loading&&"disabled",className:"basic-button",onClick:t.onUserLogout,"aria-label":"logout",children:"Logout"})})})]}),Object(st.jsxs)("div",{className:"sidebar-topic",children:[Object(st.jsx)("h3",{children:t.sidebar.name}),Object(st.jsx)("p",{children:t.sidebar.description})]})]})}))),yt=Object(a.b)((function(t){return{posts:t.posts.posts}}),(function(t){return{onGetSearchPosts:function(e){t(function(t){return function(e){e(A(!0)),e(W([])),fetch("".concat(B,"/posts/search?q=").concat(t)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e(W(t.posts)),e(A(!1))})).catch((function(t){e(D(t.message)),e(A(!1))}))}}(e))},onSetSidebar:function(e,n,o){t(nt(e,n,o))}}}))((function(t){var e=Object(r.g)(),n=new URLSearchParams(e.search).get("q");Object(o.useEffect)((function(){console.log(n),t.onGetSearchPosts(n),t.onSetSidebar(!0,"","")}),[n]);var c=t.posts.map((function(t,e){return Object(st.jsxs)("li",{children:[Object(st.jsx)("div",{className:"post-number",children:Object(st.jsx)("p",{children:e+1})}),Object(st.jsx)("div",{className:"post-votes",children:Object(st.jsx)("p",{children:"Votes"})}),Object(st.jsxs)("div",{children:[Object(st.jsx)("div",{className:"post-title",children:Object(st.jsx)(it.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(st.jsxs)("p",{className:"post-subtitle",children:["submitted ",at(t.time)," by"," ",Object(st.jsx)("span",{className:"post-username",children:t.username})," in"," ",Object(st.jsx)(it.b,{to:"/topics/".concat(t.topic),children:t.topic})]})]})]},t.post_id)}));return Object(st.jsx)("section",{className:"Home",children:Object(st.jsx)("ul",{className:"posts-list",children:c})})})),Nt=(n(25),Object(a.b)((function(t){return{error:t.flash.error,timeout:t.flash.timeout}}),(function(t){return{onSetError:function(e){t(D(e))},onSetTimeout:function(e){t(F(e))}}}))((function(t){var e=null;return Object(o.useEffect)((function(){clearTimeout(t.timeout);""!==t.error&&t.onSetTimeout(setTimeout((function(){t.onSetError("")}),5e3))}),[t.error]),""!==t.error&&(e=Object(st.jsx)("div",{className:"Flash error",onClick:function(){return t.onSetError("")},children:Object(st.jsx)("h1",{children:t.error})})),e}))),Tt=Object(a.b)((function(t){return{success:t.flash.success,timeout:t.flash.timeout}}),(function(t){return{onSetSuccess:function(e){t(k(e))},onSetTimeout:function(e){t(F(e))}}}))((function(t){var e=null;return Object(o.useEffect)((function(){clearTimeout(t.timeout);""!==t.success&&t.onSetTimeout(setTimeout((function(){t.onSetSuccess("")}),5e3))}),[t.success]),""!==t.success&&(e=Object(st.jsx)("div",{className:"Flash success",onClick:function(){return t.onSetSuccess("")},children:Object(st.jsx)("h1",{children:t.success})})),e})),_t=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{}}))((function(t){var e=null;return t.loading&&(e=Object(st.jsx)("div",{className:"Flash loading",children:Object(st.jsxs)("div",{className:"lds-ellipsis",children:[Object(st.jsx)("div",{}),Object(st.jsx)("div",{}),Object(st.jsx)("div",{}),Object(st.jsx)("div",{})]})})),e})),Et=Object(a.b)((function(t){return{registerModal:t.auth.registerModal,loginModal:t.auth.loginModal}}),(function(t){return{onAuthorize:function(e){t(G(e))}}}))((function(t){return Object(o.useEffect)((function(){if(function(){var t=localStorage.getItem("expires");return t&&Number(t)>Date.now()}()){var e=Object(l.a)(localStorage.getItem("token"));t.onAuthorize(e.sub)}}),[]),Object(st.jsxs)("div",{className:"App",children:[Object(st.jsx)(ct,{}),Object(st.jsx)(rt,{}),Object(st.jsx)(Nt,{}),Object(st.jsx)(Tt,{}),Object(st.jsx)(_t,{}),Object(st.jsxs)("div",{className:"main-grid",children:[Object(st.jsx)("main",{children:Object(st.jsxs)(r.c,{children:[Object(st.jsx)(r.a,{path:"/",exact:!0,children:Object(st.jsx)(lt,{})}),Object(st.jsx)(r.a,{path:"/newpost",children:Object(st.jsx)(jt,{})}),Object(st.jsx)(r.a,{path:"/newtopic",children:Object(st.jsx)(ht,{})}),Object(st.jsx)(r.a,{path:"/search",children:Object(st.jsx)(yt,{})}),Object(st.jsx)(r.a,{path:"/topics",exact:!0,children:Object(st.jsx)(vt,{})}),Object(st.jsx)(r.a,{path:"/topics/:topic",exact:!0,children:Object(st.jsx)(pt,{})}),Object(st.jsx)(r.a,{path:"/topics/:topic/:post_id",exact:!0,children:Object(st.jsx)(xt,{})})]})}),t.registerModal?Object(st.jsx)(bt,{}):null,t.loginModal?Object(st.jsx)(mt,{}):null,Object(st.jsx)(St,{})]})]})})),Ct=n(18),It=n(27),Pt={isAuth:!1,user_id:null,registerModal:!1,loginModal:!1},Lt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{isAuth:!0,user_id:e.user_id})},Rt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{isAuth:!1,user_id:null})},Mt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{registerModal:!t.registerModal})},Dt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{loginModal:!t.loginModal})},kt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return Lt(t,e);case d:return Rt(t);case b:return Mt(t);case m:return Dt(t);default:return t}},At={posts:[],post:{}},Ft=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{posts:e.posts})},Gt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{post:Object(H.a)(Object(H.a)({},e.post),{},{editing:!1})})},zt=function(t,e){var n=Object(H.a)({},t.post);return n.editing=!n.editing,e.canceled&&(n.text=n.original),n.original=n.text,Object(H.a)(Object(H.a)({},t),{},{post:n})},Ut=function(t,e){var n=Object(H.a)({},t.post);return n.text=e.value,Object(H.a)(Object(H.a)({},t),{},{post:n})},qt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case j:return Ft(t,e);case h:return Gt(t,e);case p:return zt(t,e);case f:return Ut(t,e);default:return t}},Bt=n(17),Ht={topics:[]},Jt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{topics:e.topics})},Vt=function(t,e){var n,o=[],c=Object(Bt.a)(t.topics);try{for(c.s();!(n=c.n()).done;){var i=n.value;o.push(Object(H.a)({},i))}}catch(s){c.e(s)}finally{c.f()}return Object(H.a)(Object(H.a)({},t),{},{topics:[].concat(o,[e.topic])})},Yt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case _:return Jt(t,e);case E:return Vt(t,e);default:return t}},Xt={sidebar:{isHome:!0,name:"",description:""},show:!1},Zt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{sidebar:{isHome:e.isHome,name:e.name,description:e.description}})},Wt=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{show:!t.show})},Kt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case C:return Zt(t,e);case I:return Wt(t);default:return t}},Qt=n(28),$t={comments:[]},te=function(t){var e,n=[],o=Object(Bt.a)(t);try{for(o.s();!(e=o.n()).done;){var c=e.value;n.push(Object(H.a)({},c))}}catch(i){o.e(i)}finally{o.f()}return n},ee=function(t,e){var n,o=e.comments,c=Object(Bt.a)(o);try{for(c.s();!(n=c.n()).done;){var i=n.value;i.reply="",i.showReply=!1,i.editing=!1,i.show=!0}}catch(s){c.e(s)}finally{c.f()}return Object(H.a)(Object(H.a)({},t),{},{comments:e.comments})},ne=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{comments:[].concat(Object(Qt.a)(t.comments),[Object(H.a)(Object(H.a)({},e.comment),{},{reply:"",showReply:!1,editing:!1,show:!0})])})},oe=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].showReply=!n[o].showReply,Object(H.a)(Object(H.a)({},t),{},{comments:n})},ce=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].reply=e.value,Object(H.a)(Object(H.a)({},t),{},{comments:n})},ie=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].reply="",Object(H.a)(Object(H.a)({},t),{},{comments:n})},se=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].text="[deleted]",n[o].user_id=11,n[o].username="[deleted]",Object(H.a)(Object(H.a)({},t),{},{comments:n})},re=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].editing=!n[o].editing,e.canceled&&(n[o].text=n[o].original),n[o].original=n[o].text,Object(H.a)(Object(H.a)({},t),{},{comments:n})},ae=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].text=e.value,Object(H.a)(Object(H.a)({},t),{},{comments:n})},le=function(t,e){var n=te(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].show=!n[o].show,Object(H.a)(Object(H.a)({},t),{},{comments:n})},ue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case T:return ee(t,e);case O:return ne(t,e);case g:return oe(t,e);case x:return ce(t,e);case v:return ie(t,e);case w:return se(t,e);case S:return re(t,e);case y:return ae(t,e);case N:return le(t,e);default:return t}},de={success:"",error:"",loading:!1,timeout:null},be=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{error:e.error,success:""})},me=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{success:e.success,error:""})},je=function(t,e){var n={};return e.loading&&(n.error="",n.success=""),Object(H.a)(Object(H.a)(Object(H.a)({},t),n),{},{loading:e.loading})},he=function(t,e){return Object(H.a)(Object(H.a)({},t),{},{timeout:e.timeout})},pe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case P:return be(t,e);case L:return me(t,e);case R:return je(t,e);case M:return he(t,e);default:return t}},fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Ct.c,Oe=Object(Ct.b)({auth:kt,posts:qt,comments:ue,topics:Yt,sidebar:Kt,flash:pe}),ge=Object(Ct.d)(Oe,fe(Object(Ct.a)(It.a)));s.a.render(Object(st.jsx)(c.a.StrictMode,{children:Object(st.jsx)(a.a,{store:ge,children:Object(st.jsx)(it.a,{children:Object(st.jsx)(Et,{})})})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.b6bdc4b8.chunk.js.map