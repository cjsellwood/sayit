(this.webpackJsonpsayit=this.webpackJsonpsayit||[]).push([[0],{26:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){},40:function(t,e,n){},46:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},51:function(t,e,n){},52:function(t,e,n){},53:function(t,e,n){},54:function(t,e,n){"use strict";n.r(e);var o=n(1),c=n.n(o),s=n(21),r=n.n(s),i=(n(33),n(34),n(6)),a=n(3),l=n(13),u="AUTHORIZE",d="DEAUTHORIZE",b="TOGGLE_REGISTER_MODAL",j="TOGGLE_LOGIN_MODAL",m="RESET_HISTORY",p="LOAD_POSTS",h="LOAD_MORE_POSTS",f="SET_SINGLE_POST",O="TOGGLE_EDIT_POST",g="EDIT_POST_INPUT",x="SET_POST_VOTE",v="SET_SINGLE_POST_VOTE",S="CHANGE_ORDER",w="CHANGE_FILTER",_="SORT_POSTS",N="ADD_COMMENT",y="TOGGLE_REPLY_FORM",E="REPLY_INPUT",T="RESET_REPLY_INPUT",C="SET_DELETED_COMMENT",P="TOGGLE_EDIT_COMMENT",L="EDIT_COMMENT_INPUT",I="TOGGLE_SHOW_COMMENT",k="SET_SINGLE_POST_COMMENTS",R="SET_TOPICS",A="SET_ADDED_TOPIC",M="SET_SIDEBAR",D="TOGGLE_SIDEBAR",F="SET_ERROR",G="SET_SUCCESS",U="SET_LOADING",H="SET_TIMEOUT",z=function(t){return{type:F,error:t}},B=function(t){return{type:G,success:t}},q=function(t){return{type:U,loading:t}},J=function(t){return{type:H,timeout:t}},V="https://sheltered-lake-91716.herokuapp.com",Y=function(t){return{type:u,user_id:t}},Z=function(){return function(t){t((localStorage.removeItem("token"),localStorage.removeItem("expires"),{type:d})),t(B("Logged out"))}},W=function(){return{type:b}},X=function(){return{type:j}},$=n(2),K=function(t){return{type:N,comment:t}},Q=function(t){return{type:y,comment_id:t}},tt=function(t,e,n){return function(o){o(q(!0));var c=localStorage.getItem("token");fetch("".concat(V,"/comments/new"),{method:"POST",body:JSON.stringify({text:t,post_id:e,parent:n}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);o(K(t.comment)),o({type:T,comment_id:n}),o(Q(n)),o(q(!1)),o(B(t.message))})).catch((function(t){o(q(!1)),o(z(t.message))}))}},et=function(t){return function(e){e(q(!0));var n=localStorage.getItem("token");fetch("".concat(V,"/comments/").concat(t,"/delete"),{method:"DELETE",body:JSON.stringify({comment_id:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}}).then((function(t){return t.json()})).then((function(n){if(n.error)throw new Error(n.error);e(function(t){return{type:C,comment_id:t}}(t)),e(q(!1)),e(B(n.message))})).catch((function(t){e(q(!1)),e(z(t.message))}))}},nt=function(t,e){return{type:P,comment_id:t,canceled:e}},ot=function(t,e){return function(n){n(q(!0));var o=localStorage.getItem("token");t.topic=t.topic.split(" ").join("").toLowerCase(),fetch("".concat(V,"/posts/new"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(o){if(o.error)throw new Error(o.error);n({type:m}),e.push("/topics/".concat(t.topic,"/").concat(o.post_id)),n(q(!1)),n(B(o.message))})).catch((function(t){n(z(t.message)),n(q(!1))}))}},ct=function(t,e){return{type:p,posts:t,pageName:e}},st=function(t,e){return{type:h,posts:t,pageName:e}},rt=function(t){return{type:f,post:t}},it=function(t){return function(e){e(q(!0));var n=localStorage.getItem("token"),o="";if(n){var c=Object(l.a)(n).sub;o+="?user_id=".concat(c)}fetch("".concat(V,"/posts/").concat(t).concat(o)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);var n;e(rt(t.post)),e((n=t.comments,{type:k,comments:n})),e(q(!1))})).catch((function(t){e(z(t.message)),e(q(!1))}))}},at=function(t){return{type:O,canceled:t}},lt=function(t,e,n){return function(o){var c=localStorage.getItem("token");fetch("".concat(V,"/posts/").concat(e,"/vote"),{method:"POST",body:JSON.stringify({post_id:e,vote:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}}).then((function(t){return t.json()})).then((function(c){if(c.error)throw new Error(c.error);o(n?function(t,e){return{type:v,vote:t,post_id:e}}(t,e):function(t,e){return{type:x,vote:t,post_id:e}}(t,e))})).catch((function(t){o(z(t.message))}))}},ut=function(t){return{type:_,order:t}},dt=function(){return function(t){t(q(!0)),fetch("".concat(V,"/posts/topics")).then((function(t){return t.json()})).then((function(e){if(e.error)throw new Error(e.error);var n;t((n=e.topics,{type:R,topics:n})),t(q(!1))})).catch((function(e){t(q(!1)),t(z(e.message))}))}},bt=function(t){return function(e){e(q(!0)),fetch("".concat(V,"/posts/singletopic"),{method:"POST",body:JSON.stringify({topic:t}),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e(function(t){return{type:A,topic:t}}(t.topic)),e(q(!1))})).catch((function(t){e(q(!1)),e(z(t.message))}))}},jt=function(t,e,n){return{type:M,isHome:t,name:e,description:n}},mt=function(){return{type:D}},pt=n(4),ht=(n(40),n(0)),ft=Object(a.b)((function(t){return{isAuth:t.auth.isAuth,sidebar:t.sidebar.sidebar,sidebarShow:t.sidebar.show}}),(function(t){return{onToggleSidebar:function(){t(mt())}}}))((function(t){return Object(ht.jsx)("nav",{className:"Nav",children:Object(ht.jsxs)("ul",{children:[Object(ht.jsx)("li",{children:Object(ht.jsx)(pt.b,{to:"/",className:"nav-logo",onClick:t.sidebarShow?t.onToggleSidebar:null,children:"Sayit"})}),Object(ht.jsx)("button",{className:"menu-button",onClick:t.onToggleSidebar,"aria-label":"toggle-sidebar",children:t.sidebarShow?Object(ht.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})}):Object(ht.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{fillRule:"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})})})]})})})),Ot=n(7),gt=function(t){var e=(Date.now()-new Date(t))/1e3;return e<60?"".concat(e.toFixed(0)," seconds ago"):e<3600?"".concat((e/60).toFixed(0)," minutes ago"):e<86400?"".concat((e/3600).toFixed(0)," hours ago"):e<31536e3?"".concat((e/86400).toFixed(0)," days ago"):"".concat((e/31536e3).toFixed(0)," years ago")},xt=Object(a.b)((function(t){return{isAuth:t.auth.isAuth,user_id:t.auth.user_id}}),(function(t){return{onSetError:function(e){t(z(e))},onPostVote:function(e,n,o){t(lt(e,n,o))}}}))((function(t){return Object(ht.jsxs)("div",{className:"post-votes",children:[Object(ht.jsx)("svg",{onClick:function(){return t.isAuth?1===t.user_vote?t.onPostVote(0,t.post_id,t.single_post):void t.onPostVote(1,t.post_id,t.single_post):t.onSetError("Login to vote")},className:t.user_id&&1===t.user_vote?"vote-up":null,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),Object(ht.jsx)("p",{children:t.votes}),Object(ht.jsx)("svg",{onClick:function(){return t.isAuth?-1===t.user_vote?t.onPostVote(0,t.post_id,t.single_post):void t.onPostVote(-1,t.post_id,t.single_post):t.onSetError("Login to vote")},className:t.user_id&&-1===t.user_vote?"vote-down":null,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})})]})})),vt=(n(46),Object(a.b)((function(t){return{order:t.posts.order,filter:t.posts.filter}}),(function(t){return{onChangeOrder:function(e){t(function(t){return{type:S,order:t}}(e))},onChangeFilter:function(e){t(function(t){return{type:w,filter:t}}(e))}}}))((function(t){return Object(ht.jsx)("div",{children:Object(ht.jsxs)("form",{className:"posts-options-form",children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"order-select"}),Object(ht.jsxs)("select",{id:"order-select",value:t.order,onChange:function(e){return t.onChangeOrder(e.target.value)},children:[Object(ht.jsx)("option",{value:"most",children:"Most Votes"}),Object(ht.jsx)("option",{value:"least",children:"Least Votes"}),Object(ht.jsx)("option",{value:"newest",children:"Newest"}),Object(ht.jsx)("option",{value:"oldest",children:"Oldest"})]})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"filter-select"}),Object(ht.jsxs)("select",{id:"filter-select",value:t.filter,onChange:function(e){return t.onChangeFilter(e.target.value)},children:[Object(ht.jsx)("option",{value:"day",children:"Day"}),Object(ht.jsx)("option",{value:"week",children:"Week"}),Object(ht.jsx)("option",{value:"month",children:"Month"}),Object(ht.jsx)("option",{value:"year",children:"Year"}),Object(ht.jsx)("option",{value:"all",children:"All"})]})]})]})})}))),St=Object(a.b)((function(t){return{posts:t.posts.posts,loading:t.flash.loading,history:t.posts.history,order:t.posts.order,filter:t.posts.filter,page:t.posts.page}}),(function(t){return{onGetPosts:function(e,n,o){t(function(t,e,n){return function(o){if("allLoaded"!==n){o(q(!0)),n||o(ct([]));var c=localStorage.getItem("token"),s="?order=".concat(t,"&filter=").concat(e,"&offset=").concat(n?25*n:0);if(c){var r=Object(l.a)(c).sub;s+="&user_id=".concat(r)}fetch("".concat(V,"/posts").concat(s)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);o(n?st(t.posts,"home"):ct(t.posts,"home")),o(q(!1))})).catch((function(t){"No posts found"===t.message?o(ct([],"home")):"No more posts found"===t.message&&o(st([],"home")),o(z(t.message)),o(q(!1))}))}}}(e,n,o))},onSetSidebar:function(e,n,o){t(jt(e,n,o))},onSortPosts:function(e){t(ut(e))}}}))((function(t){var e=Object(o.useState)(!1),n=Object(Ot.a)(e,2),s=n[0],r=n[1];Object(o.useEffect)((function(){s&&(t.posts.length<25||"allLoaded"===t.page)?t.onSortPosts(t.order):s&&t.onGetPosts(t.order,t.filter)}),[t.order]),Object(o.useEffect)((function(){s&&t.onGetPosts(t.order,t.filter)}),[t.filter]),Object(o.useEffect)((function(){"home"!==t.history&&t.onGetPosts(t.order,t.filter),r(!0),t.onSetSidebar(!0,"","")}),[]);var i=t.posts.map((function(t,e){return Object(ht.jsxs)("li",{children:[Object(ht.jsx)("div",{className:"post-number",children:Object(ht.jsx)("p",{children:e+1})}),Object(ht.jsx)(xt,{post_id:t.post_id,votes:t.votes,user_vote:t.user_vote}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("div",{className:"post-title",children:Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(ht.jsxs)("p",{className:"post-subtitle",children:["submitted ",gt(t.time)," by"," ",Object(ht.jsx)(pt.b,{className:"post-username",to:"/users/".concat(t.username),children:t.username})," ","in"," ",Object(ht.jsx)(pt.b,{className:"post-topic",to:"/topics/".concat(t.topic),children:t.topic})]})]})]},t.post_id)}));return Object(ht.jsxs)("section",{className:"Home",children:["home"===t.history?Object(ht.jsxs)(c.a.Fragment,{children:[Object(ht.jsx)(vt,{}),Object(ht.jsx)("ul",{className:"posts-list",children:i})]}):null,"allLoaded"!==t.page&&t.posts.length>=25?Object(ht.jsx)("div",{className:"load-more",onClick:function(){return t.onGetPosts(t.order,t.filter,t.page)},children:Object(ht.jsx)("button",{className:"basic-button","aria-label":"load more posts",children:"More Posts"})}):null]})})),wt=n(8),_t=(n(47),Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onUserRegister:function(e,n){t(function(t,e){return function(n){n(q(!0)),fetch("".concat(V,"/register"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);localStorage.setItem("token",t.token);var o=Date.now()+Number(t.expiresIn);localStorage.setItem("expires",o);var c=Object(l.a)(localStorage.getItem("token"));n(Y(c.sub)),n(W()),n(q(!1)),n(B(t.message)),e.push("/refresh"),e.goBack()})).catch((function(t){n(q(!1)),n(z(t.message))}))}}(e,n))},onToggleRegisterModal:function(){t(W())}}}))((function(t){var e=Object(o.useState)({username:"",password:"",confirmPassword:""}),n=Object(Ot.a)(e,2),c=n[0],s=n[1],r=Object(i.f)(),a=function(t){s(Object($.a)(Object($.a)({},c),{},Object(wt.a)({},t.target.name,t.target.value)))};return Object(ht.jsx)("section",{className:"modal-wrapper",onClick:function(e){e.currentTarget===e.target&&t.onToggleRegisterModal()},children:Object(ht.jsxs)("div",{children:[Object(ht.jsx)("h1",{children:"Register"}),Object(ht.jsx)("button",{className:"modal-close-button",onClick:t.onToggleRegisterModal,"aria-label":"close form",children:Object(ht.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}),Object(ht.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),t.onUserRegister(c,r)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"username",children:"Username"}),Object(ht.jsx)("input",{type:"text",name:"username",value:c.username,onChange:a,required:!0})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"password",children:"Password"}),Object(ht.jsx)("input",{type:"password",name:"password",value:c.password,onChange:a,required:!0,minLength:"8"})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),Object(ht.jsx)("input",{type:"password",name:"confirmPassword",value:c.confirmPassword,onChange:a,required:!0,minLength:"8"})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:t.loading?"disabled":null,children:"Register"})]})]})})}))),Nt=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onUserLogin:function(e,n){t(function(t,e){return function(n){n(q(!0)),fetch("".concat(V,"/login"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);localStorage.setItem("token",t.token);var o=Date.now()+Number(t.expiresIn);localStorage.setItem("expires",o);var c=Object(l.a)(localStorage.getItem("token"));n(Y(c.sub)),n(X()),n(q(!1)),n(B(t.message)),e.push("/refresh"),e.goBack()})).catch((function(t){n(q(!1)),n(z(t.message))}))}}(e,n))},onToggleLoginModal:function(){t(X())}}}))((function(t){var e=Object(o.useState)({username:"",password:""}),n=Object(Ot.a)(e,2),c=n[0],s=n[1],r=Object(i.f)(),a=function(t){s(Object($.a)(Object($.a)({},c),{},Object(wt.a)({},t.target.name,t.target.value)))};return Object(ht.jsx)("section",{className:"modal-wrapper",onClick:function(e){e.currentTarget===e.target&&t.onToggleLoginModal()},children:Object(ht.jsxs)("div",{children:[Object(ht.jsx)("h1",{children:"Login"}),Object(ht.jsx)("button",{className:"modal-close-button",onClick:t.onToggleLoginModal,"aria-label":"close form",children:Object(ht.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}),Object(ht.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),t.onUserLogin(c,r)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"username",children:"Username"}),Object(ht.jsx)("input",{type:"text",name:"username",value:c.username,onChange:a,required:!0})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"password",children:"Password"}),Object(ht.jsx)("input",{type:"password",name:"password",value:c.password,onChange:a,required:!0,minLength:"8"})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:t.loading?"disabled":null,children:"Login"})]})]})})})),yt=(n(48),Object(a.b)((function(t){return{}}),(function(t){return{onNewPost:function(e,n){t(ot(e,n))}}}))((function(t){var e=Object(i.f)(),n=Object(o.useState)({title:"",text:"",topic:""}),c=Object(Ot.a)(n,2),s=c[0],r=c[1];Object(o.useEffect)((function(){e.location.state&&r(Object($.a)(Object($.a)({},s),{},{topic:e.location.state.topic}))}),[]);var a=function(t){r(Object($.a)(Object($.a)({},s),{},Object(wt.a)({},t.target.name,t.target.value)))};return Object(ht.jsxs)("section",{children:[Object(ht.jsx)("h1",{className:"page-title",children:"New Post"}),Object(ht.jsxs)("form",{className:"auth-form new-post-form",onSubmit:function(n){n.preventDefault(),t.onNewPost(s,e)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"title",children:"Title*"}),Object(ht.jsx)("input",{type:"text",name:"title",value:s.title,onChange:a,required:!0})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"text",children:"Text"}),Object(ht.jsx)("textarea",{type:"text",name:"text",value:s.text,onChange:a})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"topic",children:"Topic*"}),Object(ht.jsx)("input",{type:"text",name:"topic",value:s.topic,onChange:a,required:!0})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",children:"Submit"})]})]})}))),Et=(n(49),Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onNewTopic:function(e,n){t(function(t,e){return function(n){n(q(!0));var o=localStorage.getItem("token");t.name=t.name.split(" ").join("").toLowerCase(),fetch("".concat(V,"/newtopic"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(o){if(o.error)throw new Error(o.error);e.push("/topics/".concat(t.name)),n(q(!0)),n(B(o.message))})).catch((function(t){n(q(!1)),n(z(t.message))}))}}(e,n))},onSetSidebar:function(e,n,o){t(jt(e,n,o))}}}))((function(t){var e=Object(i.f)();Object(o.useEffect)((function(){t.onSetSidebar(!0,"","")}),[]);var n=Object(o.useState)({name:"",description:""}),c=Object(Ot.a)(n,2),s=c[0],r=c[1],a=function(t){r(Object($.a)(Object($.a)({},s),{},Object(wt.a)({},t.target.name,t.target.value)))};return Object(ht.jsxs)("section",{children:[Object(ht.jsx)("h1",{className:"page-title",children:"New Topic"}),Object(ht.jsxs)("form",{className:"auth-form new-topic-form",onSubmit:function(n){n.preventDefault(),t.onNewTopic(s,e)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"name",children:"Name*"}),Object(ht.jsx)("input",{type:"text",name:"name",value:s.name,onChange:a,required:!0,maxLength:"100"})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"text",children:"Description*"}),Object(ht.jsx)("input",{type:"text",name:"description",value:s.description,onChange:a,required:!0,maxLength:"255"})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!t.loading&&"disabled",children:"Submit"})]})]})}))),Tt=Object(a.b)((function(t){return{posts:t.posts.posts,topics:t.topics.topics,error:t.flash.error,loading:t.flash.loading,history:t.posts.history,order:t.posts.order,filter:t.posts.filter,page:t.posts.page}}),(function(t){return{onGetTopicPosts:function(e,n,o,c){t(function(t,e,n,o){return function(c){if("allLoaded"!==o){c(q(!0)),o||c(ct([]));var s=localStorage.getItem("token"),r="?order=".concat(e,"&filter=").concat(n,"&offset=").concat(o?25*o:0);if(s){var i=Object(l.a)(s).sub;r+="&user_id=".concat(i)}fetch("".concat(V,"/posts/topics/").concat(t).concat(r)).then((function(t){return t.json()})).then((function(e){if(e.error)throw new Error(e.error);c(o?st(e.posts,"TOPIC: "+t):ct(e.posts,"TOPIC: "+t)),c(q(!1))})).catch((function(e){"No posts found"===e.message?c(ct([],"TOPIC: "+t)):"No more posts found"===e.message&&c(st([],"TOPIC: "+t)),c(z(e.message)),c(q(!1))}))}}}(e,n,o,c))},onAddTopic:function(e){t(bt(e))},onSetSidebar:function(e,n,o){t(jt(e,n,o))},onSortPosts:function(e){t(ut(e))}}}))((function(t){var e=Object(o.useState)(!1),n=Object(Ot.a)(e,2),s=n[0],r=n[1];Object(o.useEffect)((function(){s&&(t.posts.length<25||"allLoaded"===t.page)?t.onSortPosts(t.order):s&&t.onGetTopicPosts(a,t.order,t.filter)}),[t.order]),Object(o.useEffect)((function(){s&&t.onGetTopicPosts(a,t.order,t.filter)}),[t.filter]);var a=Object(i.h)().topic;a=a.toLowerCase(),Object(o.useEffect)((function(){t.history!=="TOPIC: "+a&&t.onGetTopicPosts(a,t.order,t.filter),r(!0)}),[a]),Object(o.useEffect)((function(){var e=-1;t.topics.length&&(e=t.topics.findIndex((function(t){return t&&t.name===a}))),-1===e&&t.onAddTopic(a),-1!==e&&t.onSetSidebar(!1,t.topics[e].name,t.topics[e].description)}),[a,t.topics]);var l=t.posts.map((function(t,e){return Object(ht.jsxs)("li",{children:[Object(ht.jsx)("div",{className:"post-number",children:Object(ht.jsx)("p",{children:e+1})}),Object(ht.jsx)("div",{className:"post-votes",children:Object(ht.jsx)(xt,{post_id:t.post_id,votes:t.votes,user_vote:t.user_vote})}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("div",{className:"post-title",children:Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(ht.jsxs)("p",{className:"post-subtitle",children:["submitted ",gt(t.time)," by"," ",Object(ht.jsx)(pt.b,{className:"post-username",to:"/users/".concat(t.username),children:t.username})]})]})]},t.post_id)}));return Object(ht.jsxs)("section",{children:[t.history==="TOPIC: "+a?Object(ht.jsxs)(c.a.Fragment,{children:[Object(ht.jsx)("h1",{className:"page-title",children:a}),Object(ht.jsx)(vt,{}),Object(ht.jsx)("ul",{className:"posts-list",children:l})]}):null,"allLoaded"!==t.page&&t.posts.length>=25?Object(ht.jsx)("div",{className:"load-more",onClick:function(){return t.onGetTopicPosts(a,t.order,t.filter,t.page)},children:Object(ht.jsx)("button",{className:"basic-button","aria-label":"load more posts",children:"More Posts"})}):null]})})),Ct=Object(a.b)((function(t){return{user_id:t.auth.user_id}}))((function(t){return t.user_id===t.creator_id?Object(ht.jsx)(c.a.Fragment,{children:t.children}):null})),Pt=Object(a.b)((function(t){return{isAuth:t.auth.isAuth}}))((function(t){return t.isAuth?Object(ht.jsx)(c.a.Fragment,{children:t.children}):null})),Lt=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{onToggleReplyForm:function(e){t(Q(e))},onCommentReply:function(e,n,o){t(tt(e,n,o))},onReplyInput:function(e,n){t(function(t,e){return{type:E,value:t,comment_id:e}}(e,n))},onDeleteComment:function(e){t(et(e))},onToggleEditComment:function(e,n){t(nt(e,n))},onEditCommentInput:function(e,n){t(function(t,e){return{type:L,value:t,comment_id:e}}(e,n))},onEditComment:function(e,n){t(function(t,e){return function(n){n(q(!0));var o=localStorage.getItem("token");fetch("".concat(V,"/comments/").concat(e,"/edit"),{method:"PATCH",body:JSON.stringify({text:t,comment_id:e}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(console.log(t),t.error)throw new Error(t.error);n(nt(e)),n(q(!1))})).catch((function(t){n(q(!1)),n(z(t.message))}))}}(e,n))},onToggleShowComment:function(e){t(function(t){return{type:I,comment_id:t}}(e))}}}))((function t(e){var n=e.allComments.filter((function(t){return t.parent===e.comment.comment_id})),o=null;return e.comment.show&&(o=Object(ht.jsxs)(c.a.Fragment,{children:[e.comment.editing?Object(ht.jsxs)("form",{className:"edit-comment-form",onSubmit:function(t){t.preventDefault(),e.onEditComment(e.comment.text,e.comment.comment_id)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"editComment"}),Object(ht.jsx)("textarea",{name:"text",id:"editComment",value:e.comment.text,onChange:function(t){return e.onEditCommentInput(t.target.value,e.comment.comment_id)},required:!0})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit",children:"Submit"}),Object(ht.jsx)("button",{className:"basic-button",type:"button",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleEditComment(e.comment.comment_id,!0)},children:"Cancel"})]}):Object(ht.jsx)("div",{className:"comment-text",children:Object(ht.jsx)("p",{children:e.comment.text})}),Object(ht.jsxs)(Pt,{children:[Object(ht.jsxs)("div",{className:"comment-buttons",children:[Object(ht.jsx)("button",{"data-index":e.index,disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleReplyForm(e.comment.comment_id)},children:"Reply"}),Object(ht.jsxs)(Ct,{creator_id:e.comment.user_id,children:[Object(ht.jsx)("button",{type:"button","aria-label":"delete",disabled:!!e.loading&&"disabled",onClick:function(){return e.onDeleteComment(e.comment.comment_id)},children:"Delete"}),Object(ht.jsx)("button",{type:"edit","aria-label":"edit",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleEditComment(e.comment.comment_id)},children:"Edit"})]})]}),e.comment.showReply?Object(ht.jsxs)("form",{className:"reply-form",onSubmit:function(t){t.preventDefault(),e.onCommentReply(e.comment.reply,e.post_id,e.comment.comment_id)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"commentReply"}),Object(ht.jsx)("textarea",{name:"comment",id:"commentReply",placeholder:"Reply",value:e.comment.reply,onChange:function(t){return e.onReplyInput(t.target.value,e.comment.comment_id)},required:!0})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!e.loading&&"disabled",children:"Submit"}),Object(ht.jsx)("button",{className:"basic-button",type:"button","aria-label":"cancel",disabled:!!e.loading&&"disabled",onClick:function(){return e.onToggleReplyForm(e.comment.comment_id)},children:"Cancel"})]}):null]}),Object(ht.jsx)("ul",{children:n.map((function(n){return Object(ht.jsx)(t,{allComments:e.allComments,comment:n,post_id:e.post_id,loading:e.loading,onToggleReplyForm:e.onToggleReplyForm,onReplyInput:e.onReplyInput,onCommentReply:e.onCommentReply,onDeleteComment:e.onDeleteComment,onToggleEditComment:e.onToggleEditComment,onEditCommentInput:e.onEditCommentInput,onEditComment:e.onEditComment,onToggleShowComment:e.onToggleShowComment},n.comment_id)}))})]})),Object(ht.jsxs)("li",{className:"child",children:[Object(ht.jsxs)("p",{className:"comment-subtitle",children:[Object(ht.jsx)("button",{onClick:function(){return e.onToggleShowComment(e.comment.comment_id)},children:e.comment.show?"[\u2013]":"[+]"}),Object(ht.jsx)(pt.b,{className:"post-username comment-username",to:"/users/".concat(e.comment.username),children:e.comment.username}),gt(e.comment.time)]}),e.comment.show?o:null]},e.comment.comment_id)})),It=(n(50),Object(a.b)((function(t){return{posts:t.posts.posts,post:t.posts.post,comments:t.comments.comments,topics:t.topics.topics,loading:t.flash.loading}}),(function(t){return{onSetSinglePost:function(e){t(rt(e))},onGetSinglePost:function(e){t(it(e))},onNewComment:function(e,n){t(function(t,e){return function(n){n(q(!0));var o=localStorage.getItem("token");fetch("".concat(V,"/comments/new"),{method:"POST",body:JSON.stringify(Object($.a)(Object($.a)({},t),{},{post_id:e})),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);n(K(t.comment)),n(q(!1)),n(B(t.message))})).catch((function(t){n(q(!1)),n(z(t.message))}))}}(e,n))},onDeletePost:function(e,n,o){t(function(t,e,n){return function(o){o(q(!0));var c=localStorage.getItem("token");fetch("".concat(V,"/posts/").concat(t,"/delete"),{method:"DELETE",body:JSON.stringify({post_id:t}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);e.push("/topics/".concat(n)),o(q(!1)),o(B(t.message))})).catch((function(t){o(z(t.message)),o(q(!1))}))}}(e,n,o))},onToggleEditPost:function(e){t(at(e))},onEditPostInput:function(e){t(function(t,e){return{type:g,value:t,post_id:e}}(e))},onEditPost:function(e,n){t(function(t,e){return function(n){n(q(!0));var o=localStorage.getItem("token");fetch("".concat(V,"/posts/").concat(e,"/edit"),{method:"PATCH",body:JSON.stringify({text:t,post_id:e}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);n(at()),n(q(!1))})).catch((function(t){n(z(t.message)),n(q(!1))}))}}(e,n))},onSetSidebar:function(e,n,o){t(jt(e,n,o))},onAddTopic:function(e){t(bt(e))}}}))((function(t){var e=Object(i.h)(),n=e.post_id,c=e.topic,s=Object(i.f)();Object(o.useEffect)((function(){t.post.post_id&&t.post.post_id===Number(n)||(t.onGetSinglePost(n,c,s),window.scrollTo(0,0)),t.post.post_id&&t.post.post_id===Number(n)&&t.post.topic!==c&&s.replace("/topics/".concat(t.post.topic,"/").concat(n));var e=t.topics.findIndex((function(e){return e.name===t.post.topic}));t.post.topic&&-1===e&&t.onAddTopic(t.post.topic),t.post.topic&&-1!==e&&t.onSetSidebar(!1,t.topics[e].name,t.topics[e].description)}),[n,t.post.topic,t.topics]);var r=[];if(t.post.post_id&&Number(t.post.post_id)===Number(n)){var a=null;if(t.post.text.includes("<<<Link>>>")){var l=t.post.text.replace("<<<Link>>>","");if(l.includes("youtube.com")||l.includes("youtu.be")){var u=l.match(/[A-Za-z0-9]{11}/),d=l.match(/(t=\d+)|(start=\d+)/),b="";if(d&&(b=d[0].split("=")[1]),u){var j="https://www.youtube.com/embed/".concat(u[0],"?start=").concat(b);a=Object(ht.jsx)("iframe",{src:j,title:t.post.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}}else a=/.(jpg|jpeg|png|gif|gifv|webp)$/.test(l)?Object(ht.jsx)("img",{src:t.post.text.replace("<<<Link>>>",""),alt:t.post.title}):Object(ht.jsx)("a",{href:t.post.text.replace("<<<Link>>>",""),children:t.post.text.replace("<<<Link>>>","")})}else a=Object(ht.jsx)("p",{children:t.post.text});r=Object(ht.jsxs)("div",{className:"single-post",children:[Object(ht.jsx)("div",{className:"post-votes",children:Object(ht.jsx)(xt,{post_id:t.post.post_id,votes:t.post.votes,user_vote:t.post.user_vote,single_post:!0})}),Object(ht.jsxs)("div",{className:"post-details",children:[Object(ht.jsx)("div",{className:"post-title",children:Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.post.topic,"/").concat(t.post.post_id),children:t.post.title})}),Object(ht.jsxs)("p",{className:"post-subtitle",children:["submitted ",gt(t.post.time)," by"," ",Object(ht.jsx)(pt.b,{className:"props.post-username",to:"/users/".concat(t.post.username),children:t.post.username})]}),t.post.editing?Object(ht.jsxs)("form",{className:"edit-post-form",onSubmit:function(e){e.preventDefault(),t.onEditPost(t.post.text,t.post.post_id)},children:[Object(ht.jsx)("label",{htmlFor:"editPost","aria-label":"edit post"}),Object(ht.jsx)("textarea",{id:"editPost",name:"text",value:t.post.text.toString(),onChange:function(e){return t.onEditPostInput(e.target.value)}}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("button",{className:"basic-button",type:"submit",disabled:!!t.loading&&"disabled",children:"Submit"}),Object(ht.jsx)("button",{className:"basic-button",type:"button","aria-label":"cancel",disabled:!!t.loading&&"disabled",onClick:function(){return t.onToggleEditPost(!0)},children:"Cancel"})]})]}):Object(ht.jsx)("div",{className:"post-text",children:a}),Object(ht.jsx)(Ct,{creator_id:t.post.user_id,children:Object(ht.jsxs)("div",{className:"comment-buttons",children:[Object(ht.jsx)("button",{type:"button","aria-label":"delete post",disabled:!!t.loading&&"disabled",onClick:function(){return t.onDeletePost(n,s,c)},children:"Delete"}),Object(ht.jsx)("button",{type:"button","aria-label":"edit post",disabled:!!t.loading&&"disabled",onClick:function(){return t.onToggleEditPost()},children:"Edit"})]})})]})]})}var m=Object(o.useState)({text:""}),p=Object(Ot.a)(m,2),h=p[0],f=p[1],O=t.comments.filter((function(t){return!t.parent})).map((function(e){return Object(ht.jsx)(Lt,{allComments:t.comments,comment:e,post_id:n},e.comment_id)}));return Object(ht.jsxs)("section",{children:[r,t.post.post_id&&t.post.post_id===Number(n)?Object(ht.jsxs)("div",{className:"comments-section",children:[Object(ht.jsx)("h2",{children:"Comments"}),Object(ht.jsx)(Pt,{children:Object(ht.jsxs)("form",{className:"new-comment-form",onSubmit:function(e){e.preventDefault(),t.onNewComment(h,n),f({text:""})},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"newComment","aria-label":"new comment"}),Object(ht.jsx)("textarea",{name:"text",id:"newComment",placeholder:"New Comment",value:h.text,onChange:function(t){f(Object($.a)(Object($.a)({},h),{},Object(wt.a)({},t.target.name,t.target.value)))},required:!0})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",disabled:!!t.loading&&"disabled",children:"Submit"})]})}),Object(ht.jsx)("ul",{children:O})]}):null]})}))),kt=(n(51),Object(a.b)((function(t){return{topics:t.topics.topics}}),(function(t){return{onGetTopics:function(){t(dt())},onSetSidebar:function(e,n,o){t(jt(e,n,o))}}}))((function(t){Object(o.useEffect)((function(){t.onGetTopics(),t.onSetSidebar(!0,"",""),window.scrollTo(0,0)}),[]);var e=t.topics.map((function(t){return Object(ht.jsxs)("li",{children:[Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.name),children:t.name}),Object(ht.jsx)("p",{children:t.description})]},t.topic_id)}));return Object(ht.jsxs)("section",{children:[Object(ht.jsx)("h1",{className:"page-title",children:"Topics"}),Object(ht.jsx)("ul",{className:"topics-list",children:e})]})}))),Rt=Object(a.b)((function(t){return{isAuth:t.auth.isAuth}}))((function(t){return t.isAuth?null:Object(ht.jsx)(c.a.Fragment,{children:t.children})})),At=(n(52),Object(a.b)((function(t){return{sidebar:t.sidebar.sidebar,show:t.sidebar.show,loading:t.flash.loading}}),(function(t){return{onToggleSidebar:function(){t(mt())},onUserLogout:function(){t(Z())},onToggleLoginModal:function(){t(X())},onToggleRegisterModal:function(){t(W())}}}))((function(t){var e=Object(o.useState)(""),n=Object(Ot.a)(e,2),c=n[0],s=n[1],r=Object(i.f)();return Object(ht.jsxs)("aside",{className:"sidebar ".concat(t.show?"open":""),onClick:t.onToggleSidebar,children:[Object(ht.jsx)("form",{onSubmit:function(t){t.preventDefault(),r.push("/search?q=".concat(c)),s("")},children:Object(ht.jsxs)("div",{className:"search-bar",children:[Object(ht.jsx)("label",{htmlFor:"search"}),Object(ht.jsx)("input",{type:"text",name:"search",id:"search",placeholder:"search",value:c,onChange:function(t){s(t.target.value)},required:!0,onClick:function(t){t.stopPropagation()}}),Object(ht.jsx)("button",{type:"submit","aria-label":"search",children:Object(ht.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:Object(ht.jsx)("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})})})]})}),Object(ht.jsxs)("div",{className:"sidebar-links",children:[Object(ht.jsx)(pt.b,{to:"/topics",children:"Topics"}),Object(ht.jsxs)(Pt,{children:[Object(ht.jsx)(pt.b,{to:{pathname:"/newpost",state:{topic:t.sidebar.name}},children:"New Post"}),Object(ht.jsx)(pt.b,{to:{pathname:"/newlinkpost",state:{topic:t.sidebar.name}},children:"New Link Post"}),t.sidebar.isHome?Object(ht.jsx)(pt.b,{to:"/newtopic",children:"New Topic"}):null]})]}),Object(ht.jsxs)("ul",{className:"auth-links",children:[Object(ht.jsx)(Rt,{children:Object(ht.jsx)("li",{children:Object(ht.jsx)("button",{className:"basic-button",disabled:!!t.loading&&"disabled",onClick:t.onToggleRegisterModal,"aria-label":"register",children:"Register"})})}),Object(ht.jsx)(Rt,{children:Object(ht.jsx)("li",{children:Object(ht.jsx)("button",{className:"basic-button",disabled:!!t.loading&&"disabled",onClick:t.onToggleLoginModal,"aria-label":"login",children:"Login"})})}),Object(ht.jsx)(Pt,{children:Object(ht.jsx)("li",{children:Object(ht.jsx)("button",{disabled:!!t.loading&&"disabled",className:"basic-button",onClick:t.onUserLogout,"aria-label":"logout",children:"Logout"})})})]}),Object(ht.jsxs)("div",{className:"sidebar-topic",children:[""!==t.sidebar.name?Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.sidebar.name),children:t.sidebar.name}):null,Object(ht.jsx)("p",{children:t.sidebar.description})]})]})}))),Mt=Object(a.b)((function(t){return{posts:t.posts.posts,history:t.posts.history,order:t.posts.order,filter:t.posts.filter,page:t.posts.page}}),(function(t){return{onGetSearchPosts:function(e,n,o,c){t(function(t,e,n,o){return function(c){if("allLoaded"!==o){c(q(!0)),o||c(ct([]));var s=t,r=localStorage.getItem("token");if(t+="&order=".concat(e,"&filter=").concat(n,"&offset=").concat(o?25*o:0),r){var i=Object(l.a)(r).sub;t+="&user_id=".concat(i)}fetch("".concat(V,"/posts/search?q=").concat(t)).then((function(t){return t.json()})).then((function(t){if(t.error)throw new Error(t.error);c(o?st(t.posts,"SEARCH: "+s):ct(t.posts,"SEARCH: "+s)),c(q(!1))})).catch((function(t){"No posts found"===t.message?c(ct([],"SEARCH: "+s)):"No more posts found"===t.message&&c(st([],"SEARCH: "+s)),c(z(t.message)),c(q(!1))}))}}}(e,n,o,c))},onSetSidebar:function(e,n,o){t(jt(e,n,o))},onSortPosts:function(e){t(ut(e))}}}))((function(t){var e=Object(i.g)(),n=new URLSearchParams(e.search).get("q"),s=Object(o.useState)(!1),r=Object(Ot.a)(s,2),a=r[0],l=r[1];Object(o.useEffect)((function(){a&&(t.posts.length<25||"allLoaded"===t.page)?t.onSortPosts(t.order):a&&t.onGetSearchPosts(n,t.order,t.filter)}),[t.order]),Object(o.useEffect)((function(){a&&t.onGetSearchPosts(n,t.order,t.filter)}),[t.filter]),Object(o.useEffect)((function(){t.history!=="SEARCH: "+n&&t.onGetSearchPosts(n,t.order,t.filter),l(!0),t.onSetSidebar(!0,"","")}),[n]);var u=t.posts.map((function(t,e){return Object(ht.jsxs)("li",{children:[Object(ht.jsx)("div",{className:"post-number",children:Object(ht.jsx)("p",{children:e+1})}),Object(ht.jsx)("div",{className:"post-votes",children:Object(ht.jsx)(xt,{post_id:t.post_id,votes:t.votes,user_vote:t.user_vote})}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("div",{className:"post-title",children:Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(ht.jsxs)("p",{className:"post-subtitle",children:["submitted ",gt(t.time)," by"," ",Object(ht.jsx)(pt.b,{className:"post-username",to:"/users/".concat(t.username),children:t.username})," ","in ",Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic),children:t.topic})]})]})]},t.post_id)}));return Object(ht.jsxs)("section",{children:[t.history==="SEARCH: "+n?Object(ht.jsxs)(c.a.Fragment,{children:[Object(ht.jsxs)("h1",{className:"page-title",children:["Search: ",n]}),Object(ht.jsx)(vt,{}),Object(ht.jsx)("ul",{className:"posts-list",children:u})]}):null,"allLoaded"!==t.page&&t.posts.length>=25?Object(ht.jsx)("div",{className:"load-more",onClick:function(){return t.onGetSearchPosts(n,t.order,t.filter,t.page)},children:Object(ht.jsx)("button",{className:"basic-button","aria-label":"load more posts",children:"More Posts"})}):null]})})),Dt=(n(26),Object(a.b)((function(t){return{error:t.flash.error,timeout:t.flash.timeout}}),(function(t){return{onSetError:function(e){t(z(e))},onSetTimeout:function(e){t(J(e))}}}))((function(t){var e=null;return Object(o.useEffect)((function(){clearTimeout(t.timeout);""!==t.error&&t.onSetTimeout(setTimeout((function(){t.onSetError("")}),5e3))}),[t.error]),""!==t.error&&(e=Object(ht.jsx)("div",{className:"Flash error",children:Object(ht.jsx)("h1",{children:t.error})})),e}))),Ft=Object(a.b)((function(t){return{success:t.flash.success,timeout:t.flash.timeout}}),(function(t){return{onSetSuccess:function(e){t(B(e))},onSetTimeout:function(e){t(J(e))}}}))((function(t){var e=null;return Object(o.useEffect)((function(){clearTimeout(t.timeout);""!==t.success&&t.onSetTimeout(setTimeout((function(){t.onSetSuccess("")}),5e3))}),[t.success]),""!==t.success&&(e=Object(ht.jsx)("div",{className:"Flash success",children:Object(ht.jsx)("h1",{children:t.success})})),e})),Gt=Object(a.b)((function(t){return{loading:t.flash.loading}}),(function(t){return{}}))((function(t){var e=null;return t.loading&&(e=Object(ht.jsx)("div",{className:"Flash loading",children:Object(ht.jsxs)("div",{className:"lds-ellipsis",children:[Object(ht.jsx)("div",{}),Object(ht.jsx)("div",{}),Object(ht.jsx)("div",{}),Object(ht.jsx)("div",{})]})})),e})),Ut=Object(a.b)((function(t){return{posts:t.posts.posts,loading:t.flash.loading,history:t.posts.history,order:t.posts.order,filter:t.posts.filter,page:t.posts.page}}),(function(t){return{onGetUserPosts:function(e,n,o,c){t(function(t,e,n,o){return function(c){if("allLoaded"!==o){c(q(!0)),o||c(ct([]));var s=localStorage.getItem("token"),r="?order=".concat(e,"&filter=").concat(n,"&offset=").concat(o?25*o:0);if(s){var i=Object(l.a)(s).sub;r+="&user_id=".concat(i)}fetch("".concat(V,"/posts/user/").concat(t).concat(r)).then((function(t){return t.json()})).then((function(e){if(e.error)throw new Error(e.error);c(o?st(e.posts,"USERNAME: "+t):ct(e.posts,"USERNAME: "+t)),c(q(!1))})).catch((function(e){"No posts found"===e.message?c(ct([],"USERNAME: "+t)):"No more posts found"===e.message&&c(st([]),"USERNAME: "+t),c(z(e.message)),c(q(!1))}))}}}(e,n,o,c))},onSetSidebar:function(e,n,o){t(jt(e,n,o))},onSortPosts:function(e){t(ut(e))}}}))((function(t){var e=Object(i.h)().username,n=Object(o.useState)(!1),s=Object(Ot.a)(n,2),r=s[0],a=s[1];Object(o.useEffect)((function(){r&&(t.posts.length<25||"allLoaded"===t.page)?t.onSortPosts(t.order):r&&t.onGetUserPosts(e,t.order,t.filter)}),[t.order]),Object(o.useEffect)((function(){r&&t.onGetUserPosts(e,t.order,t.filter)}),[t.filter]),Object(o.useEffect)((function(){t.history!=="USERNAME: "+e&&t.onGetUserPosts(e,t.order,t.filter),a(!0),t.onSetSidebar(!0,"","")}),[e]);var l=t.posts.map((function(t,e){return Object(ht.jsxs)("li",{children:[Object(ht.jsx)("div",{className:"post-number",children:Object(ht.jsx)("p",{children:e+1})}),Object(ht.jsx)("div",{className:"post-votes",children:Object(ht.jsx)(xt,{post_id:t.post_id,votes:t.votes,user_vote:t.user_vote})}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("div",{className:"post-title",children:Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic,"/").concat(t.post_id),children:t.title})}),Object(ht.jsxs)("p",{className:"post-subtitle",children:["submitted ",gt(t.time)," by"," ",Object(ht.jsx)("span",{className:"post-username",children:t.username})," in"," ",Object(ht.jsx)(pt.b,{to:"/topics/".concat(t.topic),children:t.topic})]})]})]},t.post_id)}));return Object(ht.jsx)("section",{className:"Home",children:t.history==="USERNAME: "+e?Object(ht.jsxs)(c.a.Fragment,{children:[Object(ht.jsx)("h1",{className:"page-title",children:e}),Object(ht.jsx)(vt,{}),Object(ht.jsx)("ul",{className:"posts-list",children:l})]}):null})})),Ht=Object(a.b)((function(t){return{}}),(function(t){return{onNewPost:function(e,n){t(ot(e,n))}}}))((function(t){var e=Object(i.f)(),n=Object(o.useState)({title:"",text:"",topic:""}),c=Object(Ot.a)(n,2),s=c[0],r=c[1];Object(o.useEffect)((function(){e.location.state&&r(Object($.a)(Object($.a)({},s),{},{topic:e.location.state.topic}))}),[]);var a=function(t){r(Object($.a)(Object($.a)({},s),{},Object(wt.a)({},t.target.name,t.target.value)))};return Object(ht.jsxs)("section",{children:[Object(ht.jsx)("h1",{className:"page-title",children:"New Link Post"}),Object(ht.jsxs)("form",{className:"auth-form new-post-form",onSubmit:function(n){n.preventDefault(),s.text="<<<Link>>>"+s.text,t.onNewPost(s,e)},children:[Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"title",children:"Title*"}),Object(ht.jsx)("input",{type:"text",name:"title",value:s.title,onChange:a,required:!0})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"text",children:"Link* (page, image or youtube)"}),Object(ht.jsx)("input",{type:"text",name:"text",value:s.text,onChange:a,required:!0})]}),Object(ht.jsxs)("div",{children:[Object(ht.jsx)("label",{htmlFor:"topic",children:"Topic*"}),Object(ht.jsx)("input",{type:"text",name:"topic",value:s.topic,onChange:a,required:!0})]}),Object(ht.jsx)("button",{className:"basic-button",type:"submit","aria-label":"submit",children:"Submit"})]})]})})),zt=(n(53),function(){return Object(ht.jsxs)("div",{className:"page-not-found",children:[Object(ht.jsx)("h1",{children:"Page Not Found"}),Object(ht.jsx)(pt.b,{to:"/",children:"Return Home"})]})}),Bt=Object(a.b)((function(t){return{registerModal:t.auth.registerModal,loginModal:t.auth.loginModal}}),(function(t){return{onAuthorize:function(e){t(Y(e))}}}))((function(t){return Object(o.useEffect)((function(){if(function(){var t=localStorage.getItem("expires");return t&&Number(t)>Date.now()}()){var e=Object(l.a)(localStorage.getItem("token"));t.onAuthorize(e.sub)}}),[]),Object(ht.jsxs)("div",{className:"App",children:[Object(ht.jsx)(ft,{}),Object(ht.jsx)(Dt,{}),Object(ht.jsx)(Ft,{}),Object(ht.jsx)(Gt,{}),Object(ht.jsxs)("div",{className:"main-grid",children:[Object(ht.jsx)("main",{children:Object(ht.jsxs)(i.c,{children:[Object(ht.jsx)(i.a,{path:"/",exact:!0,children:Object(ht.jsx)(St,{})}),Object(ht.jsx)(i.a,{path:"/newpost",children:Object(ht.jsx)(yt,{})}),Object(ht.jsx)(i.a,{path:"/newlinkpost",children:Object(ht.jsx)(Ht,{})}),Object(ht.jsx)(i.a,{path:"/newtopic",children:Object(ht.jsx)(Et,{})}),Object(ht.jsx)(i.a,{path:"/search",children:Object(ht.jsx)(Mt,{})}),Object(ht.jsx)(i.a,{path:"/users/:username",children:Object(ht.jsx)(Ut,{})}),Object(ht.jsx)(i.a,{path:"/topics",exact:!0,children:Object(ht.jsx)(kt,{})}),Object(ht.jsx)(i.a,{path:"/topics/:topic",exact:!0,children:Object(ht.jsx)(Tt,{})}),Object(ht.jsx)(i.a,{path:"/topics/:topic/:post_id",exact:!0,children:Object(ht.jsx)(It,{})}),Object(ht.jsx)(i.a,{path:"*",children:Object(ht.jsx)(zt,{})})]})}),t.registerModal?Object(ht.jsx)(_t,{}):null,t.loginModal?Object(ht.jsx)(Nt,{}):null,Object(ht.jsx)(At,{})]})]})})),qt=n(20),Jt=n(28),Vt={isAuth:!1,user_id:null,registerModal:!1,loginModal:!1},Yt=function(t,e){return Object($.a)(Object($.a)({},t),{},{isAuth:!0,user_id:e.user_id})},Zt=function(t,e){return Object($.a)(Object($.a)({},t),{},{isAuth:!1,user_id:null})},Wt=function(t,e){return Object($.a)(Object($.a)({},t),{},{registerModal:!t.registerModal})},Xt=function(t,e){return Object($.a)(Object($.a)({},t),{},{loginModal:!t.loginModal})},$t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return Yt(t,e);case d:return Zt(t);case b:return Wt(t);case j:return Xt(t);default:return t}},Kt=n(14),Qt=n(17),te={posts:[],post:{},history:null,order:"most",filter:"all",page:1},ee=function(t,e){return Object($.a)(Object($.a)({},t),{},{history:null})},ne=function(t,e){return Object($.a)(Object($.a)({},t),{},{posts:e.posts,history:e.pageName,page:1})},oe=function(t,e){var n=t.page;return 25!==e.posts.length?n="allLoaded":n+=1,Object($.a)(Object($.a)({},t),{},{posts:[].concat(Object(Qt.a)(t.posts),Object(Qt.a)(e.posts)),history:e.pageName,page:n})},ce=function(t,e){return Object($.a)(Object($.a)({},t),{},{post:Object($.a)(Object($.a)({},e.post),{},{editing:!1})})},se=function(t,e){var n=Object($.a)({},t.post);return n.editing=!n.editing,e.canceled&&(n.text=n.original),n.original=n.text,Object($.a)(Object($.a)({},t),{},{post:n})},re=function(t,e){var n=Object($.a)({},t.post);return n.text=e.value,Object($.a)(Object($.a)({},t),{},{post:n})},ie=function(t,e){var n,o=[],c=Object(Kt.a)(t.posts);try{for(c.s();!(n=c.n()).done;){var s=n.value;o.push(Object($.a)({},s))}}catch(a){c.e(a)}finally{c.f()}var r=o.findIndex((function(t){return t.post_id===e.post_id}));o[r].user_vote=e.vote;var i=t.posts[r].user_vote;return 1===i&&-1===e.vote?o[r].votes-=2:-1===i&&1===e.vote?o[r].votes+=2:1===i||-1===e.vote?o[r].votes-=1:-1!==i&&1!==e.vote||(o[r].votes+=1),Object($.a)(Object($.a)({},t),{},{posts:o})},ae=function(t,e){var n=Object($.a)({},t.post);n.user_vote=e.vote;var o=t.post.user_vote;return 1===o&&-1===e.vote?n.votes-=2:-1===o&&1===e.vote?n.votes+=2:1===o||-1===e.vote?n.votes-=1:-1!==o&&1!==e.vote||(n.votes+=1),Object($.a)(Object($.a)({},t),{},{post:n})},le=function(t,e){return Object($.a)(Object($.a)({},t),{},{order:e.order})},ue=function(t,e){return Object($.a)(Object($.a)({},t),{},{filter:e.filter})},de=function(t,e){var n=Object(Qt.a)(t.posts);switch(e.order){case"most":n=n.sort((function(t,e){return e.votes-t.votes}));break;case"least":n=n.sort((function(t,e){return t.votes-e.votes}));break;case"newest":n=n.sort((function(t,e){return new Date(e.time)<new Date(t.time)?-1:1}));break;case"oldest":n=n.sort((function(t,e){return new Date(e.time)>new Date(t.time)?-1:1}))}return Object($.a)(Object($.a)({},t),{},{posts:n})},be=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case m:return ee(t);case p:return ne(t,e);case h:return oe(t,e);case f:return ce(t,e);case O:return se(t,e);case g:return re(t,e);case x:return ie(t,e);case v:return ae(t,e);case S:return le(t,e);case w:return ue(t,e);case _:return de(t,e);default:return t}},je={topics:[]},me=function(t,e){return Object($.a)(Object($.a)({},t),{},{topics:e.topics})},pe=function(t,e){var n,o=[],c=Object(Kt.a)(t.topics);try{for(c.s();!(n=c.n()).done;){var s=n.value;o.push(Object($.a)({},s))}}catch(r){c.e(r)}finally{c.f()}return Object($.a)(Object($.a)({},t),{},{topics:[].concat(o,[e.topic])})},he=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case R:return me(t,e);case A:return pe(t,e);default:return t}},fe={sidebar:{isHome:!0,name:"",description:""},show:!1},Oe=function(t,e){return Object($.a)(Object($.a)({},t),{},{sidebar:{isHome:e.isHome,name:e.name,description:e.description}})},ge=function(t,e){return Object($.a)(Object($.a)({},t),{},{show:!t.show})},xe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case M:return Oe(t,e);case D:return ge(t);default:return t}},ve={comments:[]},Se=function(t){var e,n=[],o=Object(Kt.a)(t);try{for(o.s();!(e=o.n()).done;){var c=e.value;n.push(Object($.a)({},c))}}catch(s){o.e(s)}finally{o.f()}return n},we=function(t,e){var n,o=e.comments,c=Object(Kt.a)(o);try{for(c.s();!(n=c.n()).done;){var s=n.value;s.reply="",s.showReply=!1,s.editing=!1,s.show=!0}}catch(r){c.e(r)}finally{c.f()}return Object($.a)(Object($.a)({},t),{},{comments:e.comments})},_e=function(t,e){return Object($.a)(Object($.a)({},t),{},{comments:[].concat(Object(Qt.a)(t.comments),[Object($.a)(Object($.a)({},e.comment),{},{reply:"",showReply:!1,editing:!1,show:!0})])})},Ne=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].showReply=!n[o].showReply,Object($.a)(Object($.a)({},t),{},{comments:n})},ye=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].reply=e.value,Object($.a)(Object($.a)({},t),{},{comments:n})},Ee=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].reply="",Object($.a)(Object($.a)({},t),{},{comments:n})},Te=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].text="[deleted]",n[o].user_id=11,n[o].username="[deleted]",Object($.a)(Object($.a)({},t),{},{comments:n})},Ce=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].editing=!n[o].editing,e.canceled&&(n[o].text=n[o].original),n[o].original=n[o].text,Object($.a)(Object($.a)({},t),{},{comments:n})},Pe=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].text=e.value,Object($.a)(Object($.a)({},t),{},{comments:n})},Le=function(t,e){var n=Se(t.comments),o=n.findIndex((function(t){return t.comment_id===Number(e.comment_id)}));return n[o].show=!n[o].show,Object($.a)(Object($.a)({},t),{},{comments:n})},Ie=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case k:return we(t,e);case N:return _e(t,e);case y:return Ne(t,e);case E:return ye(t,e);case T:return Ee(t,e);case C:return Te(t,e);case P:return Ce(t,e);case L:return Pe(t,e);case I:return Le(t,e);default:return t}},ke={success:"",error:"",loading:!1,timeout:null},Re=function(t,e){return Object($.a)(Object($.a)({},t),{},{error:e.error,success:""})},Ae=function(t,e){return Object($.a)(Object($.a)({},t),{},{success:e.success,error:""})},Me=function(t,e){var n={};return e.loading&&(n.error="",n.success=""),Object($.a)(Object($.a)(Object($.a)({},t),n),{},{loading:e.loading})},De=function(t,e){return Object($.a)(Object($.a)({},t),{},{timeout:e.timeout})},Fe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case F:return Re(t,e);case G:return Ae(t,e);case U:return Me(t,e);case H:return De(t,e);default:return t}},Ge=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||qt.c,Ue=Object(qt.b)({auth:$t,posts:be,comments:Ie,topics:he,sidebar:xe,flash:Fe}),He=Object(qt.d)(Ue,Ge(Object(qt.a)(Jt.a)));r.a.render(Object(ht.jsx)(c.a.StrictMode,{children:Object(ht.jsx)(a.a,{store:He,children:Object(ht.jsx)(pt.a,{children:Object(ht.jsx)(Bt,{})})})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.2c8dd64d.chunk.js.map